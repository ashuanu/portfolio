System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(_){"use strict";var h,j,d,E,T,C,b,v,F;return{setters:[function(m){h=m.o,j=m.a,d=m.r,E=m.f},function(m){T=m.c,C=m.h,b=m.e,v=m.u,F=m.g}],execute:function(){_("h",w);var m=Object.defineProperty,p=(e,n)=>m(e,"name",{value:n,configurable:!0});let g=[];h(".js-comment-header-actions-deferred-include-fragment",{subscribe:e=>T(e,"loadstart",()=>{const n=e.closest(".js-comment");S(n)},{capture:!1,once:!0})}),h(".js-comment .contains-task-list",{add:e=>{const n=e.closest(".js-comment");S(n)}}),j("click",".js-comment-edit-button",function(e){const n=e.currentTarget.closest(".js-comment");n.classList.add("is-comment-editing");const o=q(n);o?o.addEventListener("include-fragment-replaced",()=>L(n),{once:!0}):L(n);const t=e.currentTarget.closest(".js-dropdown-details");t&&t.removeAttribute("open")});function L(e){e.querySelector(".js-write-tab").click();const n=e.querySelector(".js-comment-field");n.focus(),E(n,"change")}p(L,"focusEditForm");function q(e){return e.querySelector(".js-comment-edit-form-deferred-include-fragment")}p(q,"findEditFormDeferredIncludeFragment");function S(e){var n;(n=q(e))==null||n.setAttribute("loading","eager")}p(S,"loadEditFormDeferredIncludeFragment"),j("click",".js-comment-hide-button",function(e){const o=e.currentTarget.closest(".js-comment").querySelector(".js-minimize-comment");o&&o.classList.remove("d-none");const t=e.currentTarget.closest(".js-dropdown-details");t&&t.removeAttribute("open")}),j("click",".js-comment-hide-minimize-form",function(e){e.currentTarget.closest(".js-minimize-comment").classList.add("d-none")});function w(e){const n=e.currentTarget.closest("form"),o=e.currentTarget.getAttribute("data-confirm-text");if(C(n)&&!confirm(o))return!1;for(const s of n.querySelectorAll("input, textarea")){const i=s;i.value=i.defaultValue,i.classList.contains("session-resumable-canceled")&&(i.classList.add("js-session-resumable"),i.classList.remove("session-resumable-canceled"))}const t=e.currentTarget.closest(".js-comment");return t&&t.classList.remove("is-comment-editing"),!0}p(w,"handleCommentCancelButtonClick"),j("click",".js-comment-cancel-button",w),j("click",".js-cancel-issue-edit",function(e){const n=e.currentTarget.closest(".js-details-container");n.querySelector(".js-comment-form-error").hidden=!0}),d(".js-comment-delete, .js-comment .js-comment-update, .js-issue-update, .js-comment-minimize, .js-comment-unminimize",function(e,n,o){const t=e.closest(".js-comment");t.classList.add("is-comment-loading");const s=t.getAttribute("data-body-version");s&&o.headers.set("X-Body-Version",s)}),d(".js-comment .js-comment-update",async function(e,n){let o;const t=e.closest(".js-comment"),s=t.querySelector(".js-comment-update-error"),i=t.querySelector(".js-comment-body-error");s instanceof HTMLElement&&(s.hidden=!0),i instanceof HTMLElement&&(i.hidden=!0),g=[];try{o=await n.json()}catch(u){if(u.response.status===422){const f=JSON.parse(u.response.text);if(f.errors){s instanceof HTMLElement&&(s.textContent=`There was an error posting your comment: ${f.errors.join(", ")}`,s.hidden=!1);return}}else throw u}if(!o)return;const r=o.json;r.errors&&r.errors.length>0&&(g=r.errors,z(i));const y=t.querySelector(".js-comment-body");y&&r.body&&(y.innerHTML=r.body),t.setAttribute("data-body-version",r.newBodyVersion);const l=t.querySelector(".js-body-version");l instanceof HTMLInputElement&&(l.value=r.newBodyVersion);for(const u of t.querySelectorAll("input, textarea")){const f=u;f.defaultValue=f.value}t.classList.remove("is-comment-stale","is-comment-editing");const c=t.querySelector(".js-comment-edit-history");if(c){const u=await b(document,r.editUrl);c.innerHTML="",c.append(u)}}),h(".js-comment-body-error",{add:e=>{g&&g.length>0&&z(e)}});function z(e){const n=e.querySelector("ol");if(n){n.innerHTML="";const o=g.map(t=>{const s=document.createElement("li");return s.textContent=t,s});for(const t of o)n.appendChild(t)}e.hidden=!1}p(z,"showBodyErrors"),d(".js-comment .js-comment-delete, .js-comment .js-comment-update, .js-comment-minimize, .js-comment-unminimize",async function(e,n){const o=e.closest(".js-comment");try{await n.text()}catch(t){if(t.response.status===422){let s;try{s=JSON.parse(t.response.text)}catch(i){}s&&s.stale&&o.classList.add("is-comment-stale")}else throw t}o.classList.remove("is-comment-loading")}),d(".js-discussion-comment-unminimize, .js-discussion-comment-minimize",async function(e,n){const o=e.closest(".js-discussion-comment"),t=o.querySelector(".js-discussion-comment-error");t&&(t.hidden=!0);try{const s=await n.html();o.replaceWith(s.html)}catch(s){if(s.response.status>=400&&s.response.status<500){if(s.response.html){const i=s.response.html.querySelector(".js-discussion-comment").getAttribute("data-error");t instanceof HTMLElement&&(t.textContent=i,t.hidden=!1)}}else throw s}}),d(".js-comment-delete",async function(e,n){await n.json();let o=e.closest(".js-comment-delete-container");o||(o=e.closest(".js-comment-container")||e.closest(".js-line-comments"),o&&o.querySelectorAll(".js-comment").length!==1&&(o=e.closest(".js-comment"))),o.remove()}),d(".js-issue-update",async function(e,n){var o,t,s;const i=e.closest(".js-details-container"),r=i.querySelector(".js-comment-form-error");let y;try{y=await n.json()}catch(c){r.textContent=((s=(t=(o=c.response)==null?void 0:o.json)==null?void 0:t.errors)==null?void 0:s[0])||"Something went wrong. Please try again.",r.hidden=!1}if(!y)return;i.classList.remove("open"),r.hidden=!0;const l=y.json;if(l.issue_title!=null){i.querySelector(".js-issue-title").textContent=l.issue_title;const c=i.closest(".js-issues-results");if(c){if(c.querySelector(".js-merge-pr.is-merging")){const a=c.querySelector(".js-merge-pull-request textarea");a instanceof HTMLTextAreaElement&&a.value===a.defaultValue&&(a.value=a.defaultValue=l.issue_title)}else if(c.querySelector(".js-merge-pr.is-squashing")){const a=c.querySelector(".js-merge-pull-request .js-merge-title");a instanceof HTMLInputElement&&a.value===a.defaultValue&&(a.value=a.defaultValue=l.default_squash_commit_title)}const u=c.querySelector("button[value=merge]");u&&u.setAttribute("data-input-message-value",l.issue_title);const f=c.querySelector("button[value=squash]");f&&f.setAttribute("data-input-title-value",l.default_squash_commit_title)}}document.title=l.page_title;for(const c of e.elements)(c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement)&&(c.defaultValue=c.value)}),d(".js-comment-minimize",async function(e,n){await n.json();const o=e.closest(".js-comment"),t=o.querySelector(".js-minimize-comment");if(t&&t.classList.contains("js-update-minimized-content")){const s=e.querySelector("input[type=submit], button[type=submit]");s&&s.classList.add("disabled");const i=o.closest(".js-comment-container");i&&await v(i)}else{t&&t.classList.add("d-none");const s=e.closest(".unminimized-comment");s.classList.add("d-none"),s.classList.remove("js-comment");const r=e.closest(".js-minimizable-comment-group").querySelector(".minimized-comment");r&&r.classList.remove("d-none"),r&&r.classList.add("js-comment")}}),d(".js-comment-unminimize",async function(e,n){await n.json();const o=e.closest(".js-minimizable-comment-group"),t=o.querySelector(".unminimized-comment"),s=o.querySelector(".minimized-comment");if(t)t.classList.remove("d-none"),t.classList.add("js-comment"),s&&s.classList.add("d-none"),s&&s.classList.remove("js-comment");else{if(s){const r=s.querySelector(".timeline-comment-actions");r&&r.classList.add("d-none"),s.classList.remove("js-comment")}const i=o.closest(".js-comment-container");await v(i)}}),j("details-menu-select",".js-comment-edit-history-menu",e=>{const n=e.detail.relatedTarget.getAttribute("data-edit-history-url");if(!n)return;e.preventDefault();const o=b(document,n);F({content:o,dialogClass:"Box-overlay--wide"})},{capture:!0})}}});
//# sourceMappingURL=chunk-edit-a583be7b.js.map
