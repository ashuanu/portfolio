System.register(["./chunk-vendor.js","./chunk-frameworks.js"],function(){"use strict";var b,ee,q,te,ie,ne,T;return{setters:[function(I){b=I.t,ee=I.b,q=I.c,te=I.e,ie=I.p},function(I){ne=I.s,T=I.a}],execute:function(){var I=Object.defineProperty,me=Object.getOwnPropertyDescriptor,ge=(e,t)=>I(e,"name",{value:t,configurable:!0}),V=(e,t,i,n)=>{for(var r=n>1?void 0:n?me(t,i):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(n?a(t,i,r):a(r))||r);return n&&r&&I(t,i,r),r};let M=class extends HTMLElement{connectedCallback(){this.control&&(this.storedInput=Array(this.control.children.length).fill("")),this.addEventListener("input",this.relayInput.bind(this)),this.addEventListener("keydown",this.relayKeydown.bind(this));const e=this.closest("details");e&&e.addEventListener("toggle",()=>{e.open&&this.source.focus()})}relayKeydown(e){if((this.isControlTab(e.target)||e.target===this.source)&&(e.key==="ArrowDown"||e.key==="Tab"))e.preventDefault(),e.stopPropagation(),this.routeCustomEvent(new CustomEvent("focus-list"));else if(e.key==="Escape"){const t=this.closest("details");t&&t.removeAttribute("open")}}isControlTab(e){return!e||!this.control?!1:Array.from(this.control.children).includes(e)}relayInput(e){if(!e.target)return;const i=e.target.value;this.routeCustomEvent(new CustomEvent("input-entered",{detail:i}))}routeCustomEvent(e){this.sinks[this.selectedIndex].dispatchEvent(e)}get selectedIndex(){if(!this.control)return 0;const e=this.control.querySelector('[aria-selected="true"]');if(!e)throw new Error("no selected element");return Array.from(this.control.children).indexOf(e)}storeInput(){this.storedInput[this.selectedIndex]=this.source.value}updateInput(e){this.source.value=this.storedInput[this.selectedIndex];const t=e.detail.relatedTarget.getAttribute("data-filter-placeholder");this.source.placeholder=t,this.source.setAttribute("aria-label",t),this.notifySelected()}notifySelected(){const e=this.sinks[this.selectedIndex],t=new CustomEvent("tab-selected");e.dispatchEvent(t)}};ge(M,"InputDemuxElement"),V([b],M.prototype,"source",2),V([ee],M.prototype,"sinks",2),V([b],M.prototype,"control",2),M=V([q],M);var Se=Object.defineProperty,Ie=(e,t)=>Se(e,"name",{value:t,configurable:!0});const{getItem:xe,setItem:re,removeItem:se}=ne("localStorage",{throwQuotaErrorsOnSet:!0});var K;(function(e){e.Branch="branch",e.Tag="tag"})(K||(K={}));const W=class{constructor(e,t,i,n,r){this.knownItems=[],this.currentSearchResult=[],this.exactMatchFound=!1,this.isLoading=!0,this.fetchInProgress=!1,this.fetchFailed=!1,this.refType=e,this.selector=t,this.refEndpoint=i,this.cacheKey=n,this.nameWithOwner=r}render(){this.selector.render()}async fetchData(){if(!(!this.isLoading||this.fetchInProgress)){if(!this.bootstrapFromLocalStorage()){this.fetchInProgress=!0,this.fetchFailed=!1;const e=await fetch(`${this.refEndpoint}?type=${this.refType}`,{headers:{Accept:"application/json"}});await this.processResponse(e)}this.isLoading=!1,this.fetchInProgress=!1,this.render()}}async processResponse(e){if(this.emitStats(e),!e.ok){this.fetchFailed=!0;return}const t=e.clone(),i=await e.json();this.knownItems=i.refs,this.cacheKey=i.cacheKey,this.flushToLocalStorage(await t.text())}emitStats(e){if(!e.ok){T({incrementKey:"REF_SELECTOR_BOOT_FAILED"},!0);return}switch(e.status){case 200:{T({incrementKey:"REF_SELECTOR_BOOTED_FROM_UNCACHED_HTTP"});break}case 304:{T({incrementKey:"REF_SELECTOR_BOOTED_FROM_HTTP_CACHE"});break}default:T({incrementKey:"REF_SELECTOR_UNEXPECTED_RESPONSE"})}}search(e){if(e===""){this.currentSearchResult=this.knownItems;return}const t=[],i=[];this.exactMatchFound=!1;let n;for(const r of this.knownItems)if(n=r.indexOf(e),!(n<0)){if(n===0){e===r?(i.unshift(r),this.exactMatchFound=!0):i.push(r);continue}t.push(r)}this.currentSearchResult=[...i,...t]}bootstrapFromLocalStorage(){const e=xe(this.localStorageKey);if(!e)return!1;const t=JSON.parse(e);return t.cacheKey!==this.cacheKey||!("refs"in t)?(se(this.localStorageKey),!1):(this.knownItems=t.refs,this.isLoading=!1,T({incrementKey:"REF_SELECTOR_BOOTED_FROM_LOCALSTORAGE"}),!0)}async flushToLocalStorage(e){try{re(this.localStorageKey,e)}catch(t){if(t.message.toLowerCase().includes("quota")){this.clearSiblingLocalStorage(),T({incrementKey:"REF_SELECTOR_LOCALSTORAGE_OVERFLOWED"});try{re(this.localStorageKey,e)}catch(i){i.message.toLowerCase().includes("quota")&&T({incrementKey:"REF_SELECTOR_LOCALSTORAGE_GAVE_UP"})}}else throw t}}clearSiblingLocalStorage(){for(const e of Object.keys(localStorage))e.startsWith(W.LocalStoragePrefix)&&se(e)}get localStorageKey(){return`${W.LocalStoragePrefix}:${this.nameWithOwner}:${this.refType}`}};let X=W;Ie(X,"SearchIndex"),X.LocalStoragePrefix="ref-selector";function ye(e,t){var i=t.attributes,n,r,s,a,h,d;for(n=i.length-1;n>=0;--n)r=i[n],s=r.name,a=r.namespaceURI,h=r.value,a?(s=r.localName||s,d=e.getAttributeNS(a,s),d!==h&&e.setAttributeNS(a,s,h)):(d=e.getAttribute(s),d!==h&&e.setAttribute(s,h));for(i=e.attributes,n=i.length-1;n>=0;--n)r=i[n],r.specified!==!1&&(s=r.name,a=r.namespaceURI,a?(s=r.localName||s,t.hasAttributeNS(a,s)||e.removeAttributeNS(a,s)):t.hasAttribute(s)||e.removeAttribute(s))}var P,we="http://www.w3.org/1999/xhtml",C=typeof document=="undefined"?void 0:document;function Ce(e){!P&&C.createRange&&(P=C.createRange(),P.selectNode(C.body));var t;return P&&P.createContextualFragment?t=P.createContextualFragment(e):(t=C.createElement("body"),t.innerHTML=e),t.childNodes[0]}function B(e,t){var i=e.nodeName,n=t.nodeName;return i===n?!0:t.actualize&&i.charCodeAt(0)<91&&n.charCodeAt(0)>90?i===n.toUpperCase():!1}function be(e,t){return!t||t===we?C.createElement(e):C.createElementNS(t,e)}function Te(e,t){for(var i=e.firstChild;i;){var n=i.nextSibling;t.appendChild(i),i=n}return t}function Y(e,t,i){e[i]!==t[i]&&(e[i]=t[i],e[i]?e.setAttribute(i,""):e.removeAttribute(i))}var ae={OPTION:function(e,t){var i=e.parentNode;if(i){var n=i.nodeName.toUpperCase();n==="OPTGROUP"&&(i=i.parentNode,n=i&&i.nodeName.toUpperCase()),n==="SELECT"&&!i.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),i.selectedIndex=-1)}Y(e,t,"selected")},INPUT:function(e,t){Y(e,t,"checked"),Y(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var i=t.value;e.value!==i&&(e.value=i);var n=e.firstChild;if(n){var r=n.nodeValue;if(r==i||!i&&r==e.placeholder)return;n.nodeValue=i}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var i=-1,n=0,r=e.firstChild,s,a;r;)if(a=r.nodeName&&r.nodeName.toUpperCase(),a==="OPTGROUP")s=r,r=s.firstChild;else{if(a==="OPTION"){if(r.hasAttribute("selected")){i=n;break}n++}r=r.nextSibling,!r&&s&&(r=s.nextSibling,s=null)}e.selectedIndex=i}}},k=1,Ae=11,oe=3,he=8;function z(){}function _e(e){return e.id}function Re(e){return function(i,n,r){if(r||(r={}),typeof n=="string")if(i.nodeName==="#document"||i.nodeName==="HTML"){var s=n;n=C.createElement("html"),n.innerHTML=s}else n=Ce(n);var a=r.getNodeKey||_e,h=r.onBeforeNodeAdded||z,d=r.onNodeAdded||z,u=r.onBeforeElUpdated||z,p=r.onElUpdated||z,S=r.onBeforeNodeDiscarded||z,v=r.onNodeDiscarded||z,g=r.onBeforeElChildrenUpdated||z,w=r.childrenOnly===!0,x={},_;function R(l){_?_.push(l):_=[l]}function F(l,c){if(l.nodeType===k)for(var o=l.firstChild;o;){var f=void 0;c&&(f=a(o))?R(f):(v(o),o.firstChild&&F(o,c)),o=o.nextSibling}}function H(l,c,o){S(l)!==!1&&(c&&c.removeChild(l),v(l),F(l,o))}function ue(l){if(l.nodeType===k||l.nodeType===Ae)for(var c=l.firstChild;c;){var o=a(c);o&&(x[o]=c),ue(c),c=c.nextSibling}}ue(i);function fe(l){d(l);for(var c=l.firstChild;c;){var o=c.nextSibling,f=a(c);if(f){var y=x[f];y&&B(c,y)&&(c.parentNode.replaceChild(y,c),$(y,c))}fe(c),c=o}}function Ue(l,c,o){for(;c;){var f=c.nextSibling;(o=a(c))?R(o):H(c,l,!0),c=f}}function $(l,c,o){var f=a(c);f&&delete x[f],!(n.isSameNode&&n.isSameNode(i))&&(!o&&(u(l,c)===!1||(e(l,c),p(l),g(l,c)===!1))||(l.nodeName!=="TEXTAREA"?Ge(l,c):ae.TEXTAREA(l,c)))}function Ge(l,c){var o=c.firstChild,f=l.firstChild,y,E,D,G,L;e:for(;o;){for(G=o.nextSibling,y=a(o);f;){if(D=f.nextSibling,o.isSameNode&&o.isSameNode(f)){o=G,f=D;continue e}E=a(f);var j=f.nodeType,O=void 0;if(j===o.nodeType&&(j===k?(y?y!==E&&((L=x[y])?D===L?O=!1:(l.insertBefore(L,f),E?R(E):H(f,l,!0),f=L):O=!1):E&&(O=!1),O=O!==!1&&B(f,o),O&&$(f,o)):(j===oe||j==he)&&(O=!0,f.nodeValue!==o.nodeValue&&(f.nodeValue=o.nodeValue))),O){o=G,f=D;continue e}E?R(E):H(f,l,!0),f=D}if(y&&(L=x[y])&&B(L,o))l.appendChild(L),$(L,o);else{var Z=h(o);Z!==!1&&(Z&&(o=Z),o.actualize&&(o=o.actualize(l.ownerDocument||C)),l.appendChild(o),fe(o))}o=G,f=D}Ue(l,f,E);var ve=ae[l.nodeName];ve&&ve(l,c)}var m=i,U=m.nodeType,pe=n.nodeType;if(!w){if(U===k)pe===k?B(i,n)||(v(i),m=Te(i,be(n.nodeName,n.namespaceURI))):m=n;else if(U===oe||U===he){if(pe===U)return m.nodeValue!==n.nodeValue&&(m.nodeValue=n.nodeValue),m;m=n}}if(m===n)v(i);else if($(m,n,w),_)for(var J=0,je=_.length;J<je;J++){var Q=x[_[J]];Q&&H(Q,Q.parentNode,!1)}return!w&&m!==i&&i.parentNode&&(m.actualize&&(m=m.actualize(i.ownerDocument||C)),i.parentNode.replaceChild(m,i)),m}}var Ee=Re(ye);function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Oe="start",ze="center",Me="end",Pe=function(){function e(t){var i=t.itemCount,n=t.itemSizeGetter,r=t.estimatedItemSize;Le(this,e),this._itemSizeGetter=n,this._itemCount=i,this._estimatedItemSize=r,this._itemSizeAndPositionData={},this._lastMeasuredIndex=-1}return e.prototype.getLastMeasuredIndex=function(){return this._lastMeasuredIndex},e.prototype.getSizeAndPositionForIndex=function(i){if(i<0||i>=this._itemCount)throw Error("Requested index "+i+" is outside of range 0.."+this._itemCount);if(i>this._lastMeasuredIndex){for(var n=this.getSizeAndPositionOfLastMeasuredItem(),r=n.offset+n.size,s=this._lastMeasuredIndex+1;s<=i;s++){var a=this._itemSizeGetter({index:s});if(a==null||isNaN(a))throw Error("Invalid size returned for index "+s+" of value "+a);this._itemSizeAndPositionData[s]={offset:r,size:a},r+=a}this._lastMeasuredIndex=i}return this._itemSizeAndPositionData[i]},e.prototype.getSizeAndPositionOfLastMeasuredItem=function(){return this._lastMeasuredIndex>=0?this._itemSizeAndPositionData[this._lastMeasuredIndex]:{offset:0,size:0}},e.prototype.getTotalSize=function(){var i=this.getSizeAndPositionOfLastMeasuredItem();return i.offset+i.size+(this._itemCount-this._lastMeasuredIndex-1)*this._estimatedItemSize},e.prototype.getUpdatedOffsetForIndex=function(i){var n=i.align,r=n===void 0?Oe:n,s=i.containerSize,a=i.targetIndex;if(s<=0)return 0;var h=this.getSizeAndPositionForIndex(a),d=h.offset,u=d-s+h.size,p=void 0;switch(r){case Me:p=u;break;case ze:p=d-(s-h.size)/2;break;default:p=d;break}var S=this.getTotalSize();return Math.max(0,Math.min(S-s,p))},e.prototype.getVisibleRange=function(i){var n=i.containerSize,r=i.offset,s=i.overscanCount,a=this.getTotalSize();if(a===0)return{};var h=r+n,d=this._findNearestItem(r),u=d,p=this.getSizeAndPositionForIndex(d);for(r=p.offset+p.size;r<h&&u<this._itemCount-1;)u++,r+=this.getSizeAndPositionForIndex(u).size;return s&&(d=Math.max(0,d-s),u=Math.min(u+s,this._itemCount)),{start:d,stop:u}},e.prototype.resetItem=function(i){this._lastMeasuredIndex=Math.min(this._lastMeasuredIndex,i-1)},e.prototype._binarySearch=function(i){for(var n=i.low,r=i.high,s=i.offset,a=void 0,h=void 0;n<=r;){if(a=n+Math.floor((r-n)/2),h=this.getSizeAndPositionForIndex(a).offset,h===s)return a;h<s?n=a+1:h>s&&(r=a-1)}if(n>0)return n-1},e.prototype._exponentialSearch=function(i){for(var n=i.index,r=i.offset,s=1;n<this._itemCount&&this.getSizeAndPositionForIndex(n).offset<r;)n+=s,s*=2;return this._binarySearch({high:Math.min(n,this._itemCount-1),low:Math.floor(n/2),offset:r})},e.prototype._findNearestItem=function(i){if(isNaN(i))throw Error("Invalid offset "+i+" specified");i=Math.max(0,i);var n=this.getSizeAndPositionOfLastMeasuredItem(),r=Math.max(0,this._lastMeasuredIndex);return n.offset>=i?this._binarySearch({high:r,low:0,offset:i}):this._exponentialSearch({index:r,offset:i})},e}();function Ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var De="position:relative; overflow:hidden; width:100%; min-height:100%; will-change: transform;",ke="position:absolute; top:0; left:0; height:100%; width:100%; overflow:visible;",le=function(){function e(t,i){var n=this;Ne(this,e),this.getRowHeight=function(r){var s=r.index,a=n.options.rowHeight;return typeof a=="function"?a(s):Array.isArray(a)?a[s]:a},this.container=t,this.options=i,this.state={},this._initializeSizeAndPositionManager(i.rowCount),this.render=this.render.bind(this),this.handleScroll=this.handleScroll.bind(this),this.componentDidMount()}return e.prototype.componentDidMount=function(){var i=this,n=this.options,r=n.onMount,s=n.initialScrollTop,a=n.initialIndex,h=n.height,d=s||a!=null&&this.getRowOffset(a)||0,u=this.inner=document.createElement("div"),p=this.content=document.createElement("div");u.setAttribute("style",De),p.setAttribute("style",ke),u.appendChild(p),this.container.appendChild(u),this.setState({offset:d,height:h},function(){d&&(i.container.scrollTop=d),i.container.addEventListener("scroll",i.handleScroll),typeof r=="function"&&r()})},e.prototype._initializeSizeAndPositionManager=function(i){this._sizeAndPositionManager=new Pe({itemCount:i,itemSizeGetter:this.getRowHeight,estimatedItemSize:this.options.estimatedRowHeight||100})},e.prototype.setState=function(){var i=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments[1];this.state=Object.assign(this.state,n),requestAnimationFrame(function(){i.render(),typeof r=="function"&&r()})},e.prototype.resize=function(i,n){this.setState({height:i},n)},e.prototype.handleScroll=function(i){var n=this.options.onScroll,r=this.container.scrollTop;this.setState({offset:r}),typeof n=="function"&&n(r,i)},e.prototype.getRowOffset=function(i){var n=this._sizeAndPositionManager.getSizeAndPositionForIndex(i),r=n.offset;return r},e.prototype.scrollToIndex=function(i,n){var r=this.state.height,s=this._sizeAndPositionManager.getUpdatedOffsetForIndex({align:n,containerSize:r,targetIndex:i});this.container.scrollTop=s},e.prototype.setRowCount=function(i){this._initializeSizeAndPositionManager(i),this.render()},e.prototype.onRowsRendered=function(i){var n=this.options.onRowsRendered;typeof n=="function"&&n(i)},e.prototype.destroy=function(){this.container.removeEventListener("scroll",this.handleScroll),this.container.innerHTML=""},e.prototype.render=function(){for(var i=this.options,n=i.overscanCount,r=i.renderRow,s=this.state,a=s.height,h=s.offset,d=h===void 0?0:h,u=this._sizeAndPositionManager.getVisibleRange({containerSize:a,offset:d,overscanCount:n}),p=u.start,S=u.stop,v=document.createDocumentFragment(),g=p;g<=S;g++)v.appendChild(r(g));this.inner.style.height=this._sizeAndPositionManager.getTotalSize()+"px",this.content.style.top=this.getRowOffset(p)+"px",Ee(this.content,v,{childrenOnly:!0,getNodeKey:function(x){return x.nodeIndex}}),this.onRowsRendered({startIndex:p,stopIndex:S})},e}();function Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function Ke(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(function(e){Ke(t,e);function t(){return Fe(this,t),Ve(this,e.apply(this,arguments))}return t.prototype.onRowsRendered=function(n){var r=this,s=n.startIndex,a=n.stopIndex,h=this.options,d=h.isRowLoaded,u=h.loadMoreRows,p=h.minimumBatchSize,S=p===void 0?10:p,v=h.rowCount,g=v===void 0?0:v,w=h.threshold,x=w===void 0?15:w,_=He({isRowLoaded:d,minimumBatchSize:S,rowCount:g,startIndex:Math.max(0,s-x),stopIndex:Math.min(g-1,a+x)});_.forEach(function(R){var F=u(R);F&&F.then(function(){Be({lastRenderedStartIndex:s,lastRenderedStopIndex:a,startIndex:R.startIndex,stopIndex:R.stopIndex})&&r.render()})})},t})(le);function Be(e){var t=e.lastRenderedStartIndex,i=e.lastRenderedStopIndex,n=e.startIndex,r=e.stopIndex;return!(n>i||r<t)}function He(e){for(var t=e.isRowLoaded,i=e.minimumBatchSize,n=e.rowCount,r=e.startIndex,s=e.stopIndex,a=[],h=null,d=null,u=r;u<=s;u++){var p=t(u);p?d!==null&&(a.push({startIndex:h,stopIndex:d}),h=d=null):(d=u,h===null&&(h=u))}if(d!==null){for(var S=Math.min(Math.max(d,h+i-1),n-1),v=d+1;v<=S&&!t({index:v});v++)d=v;a.push({startIndex:h,stopIndex:d})}if(a.length)for(var g=a[0];g.stopIndex-g.startIndex+1<i&&g.startIndex>0;){var w=g.startIndex-1;if(!t({index:w}))g.startIndex=w;else break}return a}var ce=Object.defineProperty,$e=Object.getOwnPropertyDescriptor,de=(e,t)=>ce(e,"name",{value:t,configurable:!0}),N=(e,t,i,n)=>{for(var r=n>1?void 0:n?$e(t,i):t,s=e.length-1,a;s>=0;s--)(a=e[s])&&(r=(n?a(t,i,r):a(r))||r);return n&&r&&ce(t,i,r),r};let A=class extends HTMLElement{constructor(){super(...arguments);this.isCurrentVisible=!1,this.currentSelectionIndex=null}connectedCallback(){this.refType=this.getRequiredAttr("type")==="branch"?K.Branch:K.Tag;const e=this.getAttribute("current-committish");this.currentCommittish=e?atob(e):null,this.input=this.hasAttribute("initial-filter")&&this.currentCommittish||"",this.defaultBranch=atob(this.getRequiredAttr("default-branch")),this.nameWithOwner=atob(this.getRequiredAttr("name-with-owner")),this.canCreate=this.hasAttribute("can-create"),this.prefetchOnMouseover=this.hasAttribute("prefetch-on-mouseover");const t=this.getRequiredAttr("query-endpoint"),i=this.getRequiredAttr("cache-key");this.index=new X(this.refType,this,t,i,this.nameWithOwner),this.setupFetchListeners()}inputEntered(e){this.input=e.detail,this.render()}tabSelected(){this.index.fetchData()}renderTemplate(e,t){return new te(e,t,ie)}renderRow(e){const t=this.index.currentSearchResult[e];if(!t&&e>=this.listLength)return document.createElement("span");if(this.index.fetchFailed)return this.renderTemplate(this.fetchFailedTemplate,{index:e,refName:this.input});if(!t){const a=this.input===this.currentCommittish;return this.isCurrentVisible||(this.isCurrentVisible=a),this.renderTemplate(this.noMatchTemplate,{index:e,isCurrent:a,refName:this.input})}const i=this.input.length>0,n=i?"is-filtering":"",r=t===this.currentCommittish;this.isCurrentVisible||(this.isCurrentVisible=r);const s=this.renderTemplate(this.itemTemplate,{refName:t,index:e,isFilteringClass:n,urlEncodedRefName:this.urlEncodeRef(t),isCurrent:r,isNotDefault:t!==this.defaultBranch});if(i){const a=s.querySelector("span");a.textContent="";const h=t.split(this.input),d=h.length-1;for(let u=0;u<h.length;u++){const p=h[u];if(a.appendChild(document.createTextNode(p)),u<d){const S=document.createElement("b");S.textContent=this.input,a.appendChild(S)}}}return s}urlEncodeRef(e){return encodeURIComponent(e).replace("%2F","/").replace("%3A",":").replace("%2B","+")}render(){if(this.currentSelectionIndex=null,!this.index.isLoading){if(!this.virtualizedList){this.index.search(this.input),this.setupVirtualizedList();return}this.listContainer.scrollTop=0,this.index.search(this.input),this.virtualizedList.setRowCount(this.listLength)}}get listLength(){const e=this.index.currentSearchResult.length;return this.showCreateRow?e+1:e||1}get showCreateRow(){return!this.index.fetchFailed&&!this.index.exactMatchFound&&this.input!==""&&this.canCreate}getRequiredAttr(e,t=this){const i=t.getAttribute(e);if(!i)throw new Error(`Missing attribute for ${t}: ${e}`);return i}setupFetchListeners(){const e=this.closest("details");let t=!1;const i=de(()=>{t||(this.index.fetchData(),t=!0)},"fetch");if(!e||e.open){i();return}this.prefetchOnMouseover&&e.addEventListener("mouseover",i,{once:!0}),this.addEventListener("keydown",this.keydown),this.addEventListener("change",this.updateCurrent);const n=e.querySelector("input[data-ref-filter]");n&&(n.addEventListener("input",()=>{this.input=n.value,this.render()}),n.addEventListener("keydown",r=>{if(r.key==="ArrowDown"||r.key==="Tab")r.preventDefault(),r.stopPropagation(),this.focusFirstListMember();else if(r.key==="Enter"){let s=this.index.currentSearchResult.indexOf(this.input);if(s===-1)if(this.showCreateRow)s=this.listLength-1;else return;e.querySelector(`[data-index="${s}"]`).click(),r.preventDefault()}}))}focusFirstListMember(){!this.virtualizedList||(this.currentSelectionIndex=0,this.focusItemAtIndex(this.currentSelectionIndex))}updateCurrent(e){e.target instanceof HTMLInputElement&&e.target.checked&&e.target.value&&(this.currentCommittish=e.target.value)}keydown(e){if(this.currentSelectionIndex!==null){if(e.key==="Enter"){const t=document.activeElement;if(!t)return;t.click(),e.preventDefault();return}if(!(e.key==="Tab"&&e.shiftKey)&&e.key!=="Escape")switch(e.preventDefault(),e.stopPropagation(),e.key){case"ArrowUp":{this.currentSelectionIndex--,this.currentSelectionIndex<0&&(this.currentSelectionIndex=this.listLength-1),this.focusItemAtIndex(this.currentSelectionIndex);break}case"Home":{this.currentSelectionIndex=0,this.focusItemAtIndex(this.currentSelectionIndex);break}case"End":{this.currentSelectionIndex=this.listLength-1,this.focusItemAtIndex(this.currentSelectionIndex);break}case"Tab":case"ArrowDown":{this.currentSelectionIndex++,this.currentSelectionIndex>this.listLength-1&&(this.currentSelectionIndex=0),this.focusItemAtIndex(this.currentSelectionIndex);break}}}}focusItemAtIndex(e){this.virtualizedList.scrollToIndex(e,"center"),setTimeout(()=>{const t=this.listContainer.querySelector(`[data-index="${e}"]`);t&&t.focus()},20)}setupVirtualizedList(){this.listContainer.innerHTML="",this.virtualizedList=new le(this.listContainer,{height:330,rowCount:this.listLength,renderRow:this.renderRow.bind(this),rowHeight:e=>this.showCreateRow&&e===this.listLength-1?51:33,onRowsRendered:()=>{var e;this.hiddenCurrentElement&&(this.listContainer.removeChild(this.hiddenCurrentElement),delete this.hiddenCurrentElement),this.isCurrentVisible?this.isCurrentVisible=!1:this.hiddenCurrentItemTemplate&&(this.hiddenCurrentElement=document.createElement("div"),(e=this.hiddenCurrentElement)==null||e.appendChild(this.renderTemplate(this.hiddenCurrentItemTemplate,{refName:this.currentCommittish})),this.listContainer.appendChild(this.hiddenCurrentElement))},initialIndex:0,overscanCount:6})}};de(A,"RefSelectorElement"),N([b],A.prototype,"listContainer",2),N([b],A.prototype,"itemTemplate",2),N([b],A.prototype,"noMatchTemplate",2),N([b],A.prototype,"fetchFailedTemplate",2),N([b],A.prototype,"hiddenCurrentItemTemplate",2),A=N([q],A)}}});
//# sourceMappingURL=chunk-ref-selector-5af5ca68.js.map
